<Window
  x:Class="SpeechAgent.Features.Settings.SettingsView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:controls="clr-namespace:SpeechAgent.Features.Settings.FindWin.Controls"
  xmlns:converters="clr-namespace:SpeechAgent.Converters"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:SpeechAgent.Features.Settings"
  xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="clr-namespace:SpeechAgent.Features.Settings"
  Title="Voice Medic Settings"
  Width="400"
  Height="600"
  d:DataContext="{d:DesignInstance vm:SettingsViewModel}"
  AllowsTransparency="True"
  Background="Transparent"
  ResizeMode="NoResize"
  WindowStartupLocation="CenterOwner"
  WindowStyle="None"
  mc:Ignorable="d">
  <!--  전체 윈도우를 위한 둥근 테두리와 그림자  -->
  <Border
    Background="White"
    BorderBrush="#E0E0E0"
    BorderThickness="1"
    CornerRadius="8">
    <Border.Effect>
      <DropShadowEffect
        BlurRadius="10"
        Direction="270"
        Opacity="0.18"
        ShadowDepth="3"
        Color="#000000" />
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <!--  커스텀 타이틀바  -->
      <Border
        Grid.Row="0"
        Background="#2196F3"
        CornerRadius="8,8,0,0"
        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
        <Grid Height="36">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
          </Grid.ColumnDefinitions>

          <!--  앱 아이콘  -->
          <materialDesign:PackIcon
            Grid.Column="0"
            Width="20"
            Height="20"
            Margin="10,0,6,0"
            VerticalAlignment="Center"
            Foreground="White"
            Kind="CogOutline" />

          <!--  타이틀  -->
          <TextBlock
            Grid.Column="1"
            VerticalAlignment="Center"
            FontSize="14"
            FontWeight="Medium"
            Foreground="White"
            Text="Voice Medic Settings" />

          <!--  닫기 버튼  -->
          <Button
            Grid.Column="2"
            Width="28"
            Height="28"
            Margin="0,0,6,0"
            Click="CloseButton_Click"
            Foreground="White"
            Style="{StaticResource MaterialDesignIconButton}"
            ToolTip="닫기">
            <materialDesign:PackIcon
              Width="15"
              Height="15"
              Kind="Close" />
          </Button>
        </Grid>
      </Border>

      <!--  메인 콘텐츠 영역  -->
      <Grid Grid.Row="1" Margin="12">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
          <StackPanel>
            <!--  연결 키 섹션  -->
            <Border
              Margin="0,0,0,10"
              Padding="10"
              Background="#F8F9FA"
              CornerRadius="5">
              <StackPanel>
                <TextBlock
                  Margin="0,0,0,6"
                  FontSize="12"
                  FontWeight="SemiBold"
                  Foreground="#424242"
                  Text="연결 키" />
                <TextBox materialDesign:HintAssist.Hint="Connect Key를 입력하세요" Text="{Binding ConnectKey, UpdateSourceTrigger=PropertyChanged}" />
              </StackPanel>
            </Border>

            <!--  앱 선택 섹션  -->
            <Border
              Margin="0,0,0,10"
              Padding="10"
              Background="#F8F9FA"
              CornerRadius="5">
              <StackPanel>
                <TextBlock
                  Margin="0,0,0,6"
                  FontSize="12"
                  FontWeight="SemiBold"
                  Foreground="#424242"
                  Text="앱 선택" />
                <ComboBox
                  materialDesign:HintAssist.Hint="앱을 선택하세요"
                  DisplayMemberPath="Key"
                  ItemsSource="{Binding Options}"
                  SelectedItem="{Binding SelectedOption}" />
              </StackPanel>
            </Border>

            <!--  사용자 정의 섹션  -->
            <Border
              Margin="0,0,0,10"
              Padding="10"
              Background="#F8F9FA"
              CornerRadius="5"
              Visibility="{Binding IsCustomSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
              <StackPanel>
                <TextBlock
                  Margin="0,0,0,6"
                  FontSize="12"
                  FontWeight="SemiBold"
                  Foreground="#424242"
                  Text="사용자 정의 설정" />
                <TextBox
                  Margin="0,0,0,6"
                  materialDesign:HintAssist.Hint="EXE 타이틀"
                  Text="{Binding ExeTitle, UpdateSourceTrigger=PropertyChanged}" />
                <!--  차트 컨트롤 설정  -->
                <controls:ControlSettingTextBoxes
                  FirstControlType="{Binding ChartControlType, UpdateSourceTrigger=PropertyChanged}"
                  FirstHint="차트 컨트롤"
                  FirstIndex="{Binding ChartIndex, UpdateSourceTrigger=PropertyChanged}"
                  SecondControlType="{Binding ChartRegex, UpdateSourceTrigger=PropertyChanged}"
                  SecondHint="정규식"
                  SecondIndex="{Binding ChartRegexIndex, UpdateSourceTrigger=PropertyChanged}" />
                <!--  이름 컨트롤 설정  -->
                <controls:ControlSettingTextBoxes
                  FirstControlType="{Binding NameControlType, UpdateSourceTrigger=PropertyChanged}"
                  FirstHint="이름 컨트롤"
                  FirstIndex="{Binding NameIndex, UpdateSourceTrigger=PropertyChanged}"
                  SecondControlType="{Binding NameRegex, UpdateSourceTrigger=PropertyChanged}"
                  SecondHint="정규식"
                  SecondIndex="{Binding NameRegexIndex, UpdateSourceTrigger=PropertyChanged}" />
                <Button Margin="0,6,0,0" Command="{Binding FindControlCommand}">
                  컨트롤 찾기
                </Button>
              </StackPanel>
            </Border>

            <!--  사용자 정의 WinAPI 섹션  -->
            <!--<Border
              Margin="0,0,0,10"
              Padding="10"
              Background="#F8F9FA"
              CornerRadius="5"
              Visibility="{Binding IsCustomWinApiSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
              <StackPanel>
                <TextBlock
                  Margin="0,0,0,6"
                  FontSize="12"
                  FontWeight="SemiBold"
                  Foreground="#424242"
                  Text="사용자 정의 WinAPI 설정" />
                <TextBox
                  Margin="0,0,0,6"
                  materialDesign:HintAssist.Hint="EXE 타이틀"
                  Text="{Binding ExeTitle, UpdateSourceTrigger=PropertyChanged}" />
            -->
            <!--  차트 컨트롤 설정  -->
            <!--
                <controls:ControlSettingTextBoxes
                  FirstControlType="{Binding ChartControlType, UpdateSourceTrigger=PropertyChanged}"
                  FirstHint="차트 컨트롤"
                  FirstIndex="{Binding ChartIndex, UpdateSourceTrigger=PropertyChanged}"
                  SecondControlType="{Binding ChartRegex, UpdateSourceTrigger=PropertyChanged}"
                  SecondHint=""
                  SecondIndex="0" />
            -->
            <!--  이름 컨트롤 설정  -->
            <!--
                <Grid Margin="0,0,0,6">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="10" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>
                  <TextBox
                    Grid.Column="0"
                    materialDesign:HintAssist.Hint="이름 컨트롤"
                    Text="{Binding NameControlType, UpdateSourceTrigger=PropertyChanged}" />
                  <TextBox
                    Grid.Column="2"
                    materialDesign:HintAssist.Hint="Index"
                    PreviewTextInput="Index_PreviewTextInput"
                    Text="{Binding NameIndex, UpdateSourceTrigger=PropertyChanged}" />
                </Grid>
                <Button Margin="0,6,0,0" Command="{Binding FindWinApiControlCommand}">
                  컨트롤 찾기 (WinAPI)
                </Button>
              </StackPanel>
            </Border>-->

            <!--  사용자 이미지 설정 섹션  -->
            <Border
              Margin="0,0,0,10"
              Padding="10"
              Background="#F8F9FA"
              CornerRadius="5"
              Visibility="{Binding IsCustomImageSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
              <StackPanel>
                <TextBlock
                  Margin="0,0,0,6"
                  FontSize="12"
                  FontWeight="SemiBold"
                  Foreground="#424242"
                  Text="사용자 이미지 설정" />
                <TextBox
                  Margin="0,0,0,6"
                  materialDesign:HintAssist.Hint="이미지 이름"
                  Text="{Binding ExeTitle, UpdateSourceTrigger=PropertyChanged}" />
                <TextBox
                  Margin="0,0,0,6"
                  materialDesign:HintAssist.Hint="이미지 영역 (x,y,width,height)"
                  IsReadOnly="True"
                  Text="{Binding CustomImageRect, UpdateSourceTrigger=PropertyChanged}" />
                <Button Margin="0,6,0,0" Command="{Binding FindImageControlCommand}">
                  이미지 컨트롤 찾기
                </Button>
              </StackPanel>
            </Border>

            <!--  자동 시작 섹션  -->
            <Border
              Margin="0,0,0,12"
              Padding="10"
              Background="#F8F9FA"
              CornerRadius="5">
              <StackPanel>
                <TextBlock
                  Margin="0,0,0,6"
                  FontSize="12"
                  FontWeight="SemiBold"
                  Foreground="#424242"
                  Text="시스템 설정" />
                <CheckBox IsChecked="{Binding AutoStartEnabled}" Style="{StaticResource MaterialDesignCheckBox}">
                  <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon
                      Width="14"
                      Height="14"
                      Margin="0,0,6,0"
                      VerticalAlignment="Center"
                      Foreground="#616161"
                      Kind="WindowRestore" />
                    <TextBlock
                      VerticalAlignment="Center"
                      FontSize="12"
                      Foreground="#424242"
                      Text="윈도우 시작 시 자동 실행" />
                  </StackPanel>
                </CheckBox>
              </StackPanel>
            </Border>

            <!--  버튼 영역  -->
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>

              <Button
                Grid.Column="0"
                Height="32"
                Margin="0,0,3,0"
                materialDesign:ButtonAssist.CornerRadius="6"
                Command="{Binding SaveSettingsCommand}"
                Style="{StaticResource MaterialDesignRaisedButton}">
                <StackPanel Orientation="Horizontal">
                  <materialDesign:PackIcon
                    Width="15"
                    Height="15"
                    VerticalAlignment="Center"
                    Kind="ContentSave" />
                  <TextBlock
                    Margin="6,0,0,0"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Text="저장" />
                </StackPanel>
              </Button>

              <Button
                Grid.Column="1"
                Height="32"
                Margin="3,0,0,0"
                materialDesign:ButtonAssist.CornerRadius="6"
                Command="{Binding CloseCommand}"
                Style="{StaticResource MaterialDesignOutlinedButton}">
                <StackPanel Orientation="Horizontal">
                  <materialDesign:PackIcon
                    Width="15"
                    Height="15"
                    VerticalAlignment="Center"
                    Kind="Close" />
                  <TextBlock
                    Margin="6,0,0,0"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Text="닫기" />
                </StackPanel>
              </Button>
            </Grid>
          </StackPanel>
        </ScrollViewer>
      </Grid>
    </Grid>
  </Border>
</Window>
