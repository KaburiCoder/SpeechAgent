<Window x:Class="SpeechAgent.Features.Settings.SettingsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SpeechAgent.Features.Settings"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:vm="clr-namespace:SpeechAgent.Features.Settings"
        d:DataContext="{d:DesignInstance vm:SettingsViewModel}"
        mc:Ignorable="d"        
        Title="Voice Medic Settings" Height="500" Width="450"
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize">

  <!-- 전체 윈도우를 위한 둥근 테두리와 그림자 -->
  <Border Background="White" 
          CornerRadius="12" 
          BorderBrush="#E0E0E0" 
          BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#000000" 
                        Direction="270" 
                        ShadowDepth="4" 
                        BlurRadius="15" 
                        Opacity="0.2"/>
    </Border.Effect>
    
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>
      
      <!-- 커스텀 타이틀바 -->
      <Border Grid.Row="0" 
          Background="#2196F3" 
          CornerRadius="12,12,0,0" 
          MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
        <Grid Height="45">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>
          
          <!-- 앱 아이콘 -->
          <materialDesign:PackIcon Grid.Column="0" 
                                   Kind="CogOutline" 
                                   Width="24" Height="24" 
                                   Foreground="White" 
                                   VerticalAlignment="Center" 
                                   Margin="15,0,10,0"/>
    
          <!-- 타이틀 -->
          <TextBlock Grid.Column="1" 
                     Text="Voice Medic Settings" 
                     FontSize="16" 
                     FontWeight="Medium" 
                     Foreground="White" 
                     VerticalAlignment="Center"/>

          <!-- 닫기 버튼 -->
          <Button Grid.Column="2" 
                  Click="CloseButton_Click"
                  ToolTip="닫기"
                  Margin="0,0,10,0"
                  Width="35" Height="35"
                  Style="{StaticResource MaterialDesignIconButton}"
                  Foreground="White">
            <materialDesign:PackIcon Kind="Close" Width="18" Height="18" />
          </Button>
        </Grid>
      </Border>

      <!-- 메인 콘텐츠 영역 -->
      <Grid Grid.Row="1" Margin="20">
        <StackPanel>
          <!-- 연결 키 섹션 -->
          <Border Background="#F8F9FA" 
                  CornerRadius="8" 
                  Padding="15" 
                  Margin="0,0,0,15">
            <StackPanel>
              <TextBlock Text="연결 키" 
                         FontSize="14" 
                         FontWeight="SemiBold"
                         Foreground="#424242"
                         Margin="0,0,0,10"/>
              <TextBox materialDesign:HintAssist.Hint="Connect Key를 입력하세요" 
                        Style="{StaticResource MaterialDesignOutlinedTextBox}" 
                        Text="{Binding ConnectKey, UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>
          </Border>
    
          <!-- 앱 선택 섹션 -->
          <Border Background="#F8F9FA" 
                  CornerRadius="8" 
                  Padding="15" 
                  Margin="0,0,0,15">
            <StackPanel>
              <TextBlock Text="앱 선택" 
                         FontSize="14" 
                         FontWeight="SemiBold"
                         Foreground="#424242"
                         Margin="0,0,0,10"/>
              <ComboBox materialDesign:HintAssist.Hint="앱을 선택하세요" 
                        Style="{StaticResource MaterialDesignOutlinedComboBox}"
                        ItemsSource="{Binding Options}" 
                        DisplayMemberPath="Key" 
                        SelectedValuePath="Value" 
                        SelectedValue="{Binding AppName}"/>
            </StackPanel>
          </Border>

          <!-- 자동 시작 섹션 -->
          <Border Background="#F8F9FA" 
                  CornerRadius="8" 
                  Padding="15" 
                  Margin="0,0,0,20">
            <StackPanel>
              <TextBlock Text="시스템 설정" 
                         FontSize="14" 
                         FontWeight="SemiBold"
                         Foreground="#424242"
                         Margin="0,0,0,10"/>
              <CheckBox IsChecked="{Binding AutoStartEnabled}"
                        Style="{StaticResource MaterialDesignCheckBox}">
                <StackPanel Orientation="Horizontal">
                  <materialDesign:PackIcon Kind="WindowRestore" 
                                           Width="16" Height="16" 
                                           VerticalAlignment="Center"
                                           Margin="0,0,8,0"
                                           Foreground="#616161"/>
                  <TextBlock Text="윈도우 시작 시 자동 실행" 
                             FontSize="13"
                             Foreground="#424242"
                             VerticalAlignment="Center"/>
                </StackPanel>
              </CheckBox>
            </StackPanel>
          </Border>
  
          <!-- 버튼 영역 -->
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="0" 
                   Margin="0,0,5,0" 
                   Height="40"
                   Style="{StaticResource MaterialDesignRaisedButton}"
                   materialDesign:ButtonAssist.CornerRadius="8"
                   Command="{Binding SaveSettingsCommand}">
              <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="ContentSave" 
                                         Width="18" Height="18" 
                                         VerticalAlignment="Center"/>
                <TextBlock Text="저장" 
                          Margin="8,0,0,0" 
                          FontSize="14"
                          VerticalAlignment="Center"/>
              </StackPanel>
            </Button>
         
            <Button Grid.Column="1" 
                   Margin="5,0,0,0" 
                   Height="40"
                   Style="{StaticResource MaterialDesignOutlinedButton}"
                   materialDesign:ButtonAssist.CornerRadius="8"
                   Command="{Binding CloseCommand}">
              <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="Close" 
                                         Width="18" Height="18" 
                                         VerticalAlignment="Center"/>
                <TextBlock Text="닫기" 
                          Margin="8,0,0,0" 
                          FontSize="14"
                          VerticalAlignment="Center"/>
              </StackPanel>
            </Button>
          </Grid>
        </StackPanel>
      </Grid>
    </Grid>
  </Border>
</Window>
